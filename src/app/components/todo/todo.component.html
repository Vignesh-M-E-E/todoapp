<div class="container">
  <div class="header-section">
    <h1>{{ isEditMode ? 'Edit Todo' : 'Create Todo' }}</h1>
    <button type="button" (click)="logout()" class="btn-logout">Logout</button>
  </div>

  <!-- Create/Edit Form -->
  <div class="form-section">
    <form (ngSubmit)="isEditMode ? updateTodo() : createTodo()">
      <div class="form-group">
        <label for="title">Title</label>
        <input 
          type="text" 
          id="title" 
          [(ngModel)]="title" 
          name="title" 
          required 
          placeholder="Enter todo title"
        >
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea 
          id="description" 
          [(ngModel)]="description" 
          name="description" 
          required 
          placeholder="Enter todo description"
        ></textarea>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="status">Status</label>
          <select 
            id="status" 
            [(ngModel)]="status" 
            name="status" 
            required
          >
            <option *ngFor="let option of statusOptions" [value]="option">
              {{ option }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="priority">Priority</label>
          <select 
            id="priority" 
            [(ngModel)]="priority" 
            name="priority" 
            required
          >
            <option *ngFor="let option of priorityOptions" [value]="option">
              {{ option }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="date">Date</label>
          <input 
            type="date" 
            id="date" 
            [(ngModel)]="date" 
            name="date" 
            required
          >
        </div>
      </div>

      <div class="form-actions">
        <button type="submit">{{ isEditMode ? 'Update Todo' : 'Create Todo' }}</button>
        <button *ngIf="isEditMode" type="button" (click)="cancelEdit()" class="btn-cancel">Cancel</button>
      </div>
    </form>

    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <div *ngIf="successMessage" class="success-message">
      {{ successMessage }}
    </div>
  </div>

  <!-- Todos Table Section -->
  <div class="todos-section">
    <div class="section-header">
      <h2>{{ isFilterActive ? 'Filtered Todos' : 'All Todos' }}</h2>
      <div class="header-actions">
        <!-- Month Filter -->
        <div class="filter-section">
          <label for="filterMonth">Month:</label>
          <select 
            id="filterMonth" 
            [(ngModel)]="filterMonth"
            (change)="filterTodosByMonth()"
          >
            <option *ngFor="let month of monthOptions" [value]="month.value">
              {{ month.name }}
            </option>
          </select>
          
          <label for="filterYear">Year:</label>
          <input 
            type="number" 
            id="filterYear" 
            [(ngModel)]="filterYear"
            (change)="filterTodosByMonth()"
            min="2020"
            max="2100"
            style="width: 80px;"
          >
          
          <button type="button" (click)="filterTodosByMonth()" class="btn-filter">Filter</button>
          <button *ngIf="isFilterActive" type="button" (click)="clearFilter()" class="btn-clear-filter">Clear Filter</button>
        </div>
        
        <button type="button" (click)="loadTodos()" class="btn-refresh">Refresh</button>
      </div>
    </div>

    <div *ngIf="loading" class="loading">
      Loading todos...
    </div>

    <div *ngIf="!loading && todos.length === 0" class="empty-state">
      No todos found. Create your first todo above!
    </div>

    <div *ngIf="!loading && todos.length > 0" class="table-container">
      <table class="todos-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Description</th>
            <th>Date</th>
            <th>Status</th>
            <th>Priority</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let todo of todos">
            <td>{{ todo.id }}</td>
            <td>{{ todo.title }}</td>
            <td class="description-cell">{{ todo.description }}</td>
            <td>{{ todo.date | date:'MMM dd, yyyy' }}</td>
            <td>
              <span class="status-badge" [ngClass]="getStatusClass(todo.status)">
                {{ todo.status }}
              </span>
            </td>
            <td>
              <span class="priority-badge" [ngClass]="getPriorityClass(todo.priority)">
                {{ todo.priority }}
              </span>
            </td>
            <td class="actions-cell">
              <button type="button" (click)="editTodo(todo)" class="btn-edit">Edit</button>
              <button type="button" (click)="deleteTodo(todo.id)" class="btn-delete">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
